{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?80ab"],"names":["_createElementVNode","for","class","_createElementBlock","onSubmit","_ctx","_hoisted_1","_normalizeClass","invalid","_hoisted_2","type","id","$event","onBlur","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_5","disabled","_hoisted_6","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","isSubmitting","submitCount","useField","yup","trim","required","email","value","eError","errorMessage","eBlur","handleBlur","MIN_LENGTH","min","password","pError","pBlur","isTooManyAttempts","computed","watch","val","setTimeout","values","dispatch","push","setup","route","useRoute","query","message","error","__exports__","render"],"mappings":"2IAEIA,eAAwB,UAApB,mBAAe,G,EAGjBA,eAAgC,SAAzBC,IAAI,SAAQ,SAAK,G,YAMxBD,eAAoC,SAA7BC,IAAI,YAAW,UAAM,G,kCAMzBC,MAAM,e,gDAhBbC,eAiBO,QAjBDD,MAAM,OAAQE,SAAM,8CAAUC,4CAAQ,eAA5C,CACEC,EAEAN,eAIM,OAJAE,MAAKK,gCAAAC,QAA6BH,aAAxC,CACEI,iBACAT,eAA6D,SAAtDU,KAAK,QAAQC,GAAG,Q,qDAAiBN,QAAKO,IAAGC,OAAI,8BAAER,uCAAtD,mBAAwCA,WAC3BA,2BAAbF,eAAyC,QAAAW,EAAAC,eAAjBV,UAAM,IAA9B,uBAHF,GAMAL,eAIM,OAJAE,MAAKK,gCAAAC,QAA6BH,aAAxC,CACEW,iBACAhB,eAAsE,SAA/DU,KAAK,WAAWC,GAAG,W,qDAAoBN,WAAQO,IAAGC,OAAI,8BAAER,uCAA/D,mBAA8CA,cACjCA,2BAAbF,eAAyC,QAAAc,EAAAF,eAAjBV,UAAM,IAA9B,uBAHF,GAMAL,eAAsG,UAA9FE,MAAM,cAAcQ,KAAK,SAAUQ,SAAUb,gBAAgBA,qBAAmB,QAAK,EAAAc,GAC9Dd,sCAA/BF,eAAoH,MAApH,EAAkD,iEAAlD,uBAhBF,I,wHCKK,SAASiB,IACd,IAAMC,EAAQC,iBACRC,EAASC,iBACf,EAAkDC,iBAA3CC,EAAP,EAAOA,aAAcC,EAArB,EAAqBA,aAAcC,EAAnC,EAAmCA,YAEnC,EAAgEC,eAC9D,QACAC,SAEGC,OACAC,SAAS,4BACTC,MAAM,uCANGA,EAAd,EAAOC,MAA4BC,EAAnC,EAAqBC,aAAkCC,EAAvD,EAA2CC,WASrCC,EAAa,EAEnB,EAAmEV,eACjE,WACAC,SAEGC,OACAC,SAAS,6BACTQ,IAAID,EAJP,sCAIkDA,EAJlD,eAFYE,EAAd,EAAOP,MAA+BQ,EAAtC,EAAwBN,aAAkCO,EAA1D,EAA8CL,WASxCM,EAAoBC,gBAAS,kBAAMjB,EAAYM,OAAS,KAE9DY,eAAMF,GAAmB,SAAAG,GACpBA,GACDC,YAAW,kBAAMpB,EAAYM,MAAQ,IAAG,SAI5C,IAAM9B,EAAWsB,EAAY,yDAAE,WAAMuB,GAAN,0GAErB5B,EAAM6B,SAAS,aAAcD,GAFR,OAG3B1B,EAAO4B,KAAK,KAHe,0GAAF,uDAQ7B,MAAO,CACLlB,QACAQ,WACAN,SACAO,SACAL,QACAM,QACAvC,WACAuB,eACAiB,qBD9BW,OACbQ,MADa,WAEX,IAAMC,EAAQC,iBACRjC,EAAQC,iBAQd,OANG+B,EAAME,MAAMC,SACbnC,EAAM6B,SAAS,aAAc,CAC3BhB,MAAOuB,eAAMJ,EAAME,MAAMC,SACzB9C,KAAM,YAGV,kBAAWU,O,qBEhCf,MAAMsC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0be70b.df680ff5.js","sourcesContent":["<template>\r\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\r\n    <h1>Войти в систему</h1>\r\n\r\n    <div :class=\"['form-control', {invalid: eError}]\">\r\n      <label for=\"email\">Email</label>\r\n      <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\">\r\n      <small v-if=\"eError\">{{ eError }}</small>\r\n    </div>\r\n\r\n    <div :class=\"['form-control', {invalid: pError}]\">\r\n      <label for=\"password\">Пароль</label>\r\n      <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\">\r\n      <small v-if=\"pError\">{{ pError }}</small>\r\n    </div>\r\n\r\n    <button class=\"btn primary\" type=\"submit\" :disabled=\"isSubmitting || isTooManyAttempts\">Войти</button>\r\n    <div class=\"text-danger\" v-if=\"isTooManyAttempts\">Вы слишком часто пытаетесь войти в систему. Попробуйте позже</div>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from 'vue-router';\r\nimport { useStore } from 'vuex';\r\nimport {error} from '../utils/error'\r\nimport {useLoginForm} from '../use/login-form';\r\nexport default {\r\n  setup() {\r\n    const route = useRoute()\r\n    const store = useStore()\r\n\r\n    if(route.query.message) {\r\n      store.dispatch('setMessage', {\r\n        value: error(route.query.message),\r\n        type: 'warning'\r\n      })\r\n    }\r\n    return {...useLoginForm()}\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import {computed, watch} from 'vue'\r\nimport * as yup from 'yup'\r\nimport{useField, useForm} from 'vee-validate'\r\nimport { useStore } from 'vuex'\r\nimport {useRouter} from 'vue-router'\r\n\r\nexport function useLoginForm() {\r\n  const store = useStore()\r\n  const router = useRouter()\r\n  const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n  const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\r\n    'email',\r\n    yup\r\n      .string()\r\n      .trim()\r\n      .required('Пожалуйста введите email')\r\n      .email('Необходимо ввести корректный email')\r\n  )\r\n\r\n  const MIN_LENGTH = 6\r\n\r\n  const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\r\n    'password',\r\n    yup\r\n      .string()\r\n      .trim()\r\n      .required('Пожалуйста введите пароль')\r\n      .min(MIN_LENGTH, `Пароль не может быть меньше ${MIN_LENGTH} символов`)\r\n  )\r\n\r\n  const isTooManyAttempts = computed(() => submitCount.value >= 3)\r\n\r\n  watch(isTooManyAttempts, val => {\r\n    if(val) {\r\n      setTimeout(() => submitCount.value = 0, 1500)\r\n    }\r\n  })\r\n\r\n  const onSubmit = handleSubmit( async values => {\r\n    try {\r\n      await store.dispatch('auth/login', values)\r\n      router.push('/')\r\n    } catch (e) {\r\n    }\r\n  })\r\n\r\n  return {\r\n    email,\r\n    password,\r\n    eError,\r\n    pError,\r\n    eBlur,\r\n    pBlur,\r\n    onSubmit,\r\n    isSubmitting,\r\n    isTooManyAttempts\r\n  }\r\n}","import { render } from \"./Auth.vue?vue&type=template&id=11517d8c\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Даниил\\\\Desktop\\\\Vue\\\\13\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}